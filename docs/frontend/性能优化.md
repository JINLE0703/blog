---
title: 性能优化
lang: zh-CN
---

## 加载更快

1. 减少资源体积，压缩代码，比如：webpack生产环境打包代码；服务器端进行gzip压缩，能把代码压缩到1/3左右
2. 减少访问次数：合并代码（css代码可以合并，图片可以通过雪碧图合并），SSR服务器端渲染（网页和数据一起加载一起渲染），缓存
3. 使用更快的网络：CDN（根据区域获取最近的资源）

## 渲染更快

1. css放在head，JS放在body最下面
2. 尽量早开始执行JS，用DOMContentLoaded触发，没必要等到图片加载完成
3. 懒加载（图片懒加载，上滑加载更多等）
4. 对DOM查询进行缓存
5. 频繁DOM操作，合并到一起插入DOM结构
6. 节流throttle 防抖debounce，让渲染更加流畅

#### DOM 性能优化

DOM 操作会导致浏览器的重绘重排

优化：减少 DOM 操作次数

1. 缓存：本地变量缓存

2. 一次性操作：`document.createDocumentFragment()` 文档碎片、通过改变class来修改样式

   ```js
   const list = document.getElementById('list')
   // 创建一个文档片段，此时还没有插入到 DOM 结构中
   const frag = document.createDocumentFragment()
   for (let i  = 0; i < 20; i++) {
       const li = document.createElement('li')
       li.innerHTML = `List item ${i}`
       // 先插入文档片段中
       frag.appendChild(li)
   }
   // 都完成之后，再统一插入到 DOM 结构中
   list.appendChild(frag)
   console.log(list)
   ```

3. 尽量避免会导致重排的 DOM 操作，比如修改 DOM 的位置、尺寸等等
